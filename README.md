![Repository language count](https://img.shields.io/github/languages/count/didifive/ess-api)
![Repository code size](https://img.shields.io/github/languages/code-size/didifive/ess-api)
[![GitHub last commit](https://img.shields.io/github/last-commit/didifive/ess-api?color=blue)](https://github.com/didifive/ess-api/commits/master)
[![Made by Didi](https://img.shields.io/badge/made%20by-Didi-green)](https://www.linkedin.com/in/luis-carlos-zancanela/)
![Repository license](https://img.shields.io/github/license/didifive/ess-api)

![technology Java](https://img.shields.io/static/v1?color=red&label=Technology&message=Java&style=for-the-badge&logo=data:image/png;base64,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)
![technology Spring](https://img.shields.io/static/v1?color=6DB33F&label=Technology&message=Spring&style=for-the-badge&logo=spring)

# API Escola Shining Stars (ESS) üåü

RESTful Desenvolvimento da API para projeto do bootcamp Java AI Powered da DIO.

Constru√≠da com Java 21 e Spring Boot 3.2.3.

---

## üéØ Objetivo 
Este √© um projeto de API criado a partir de desafio de projeto do bootcamp Java AI Powered da DIO.  
O primeiro desafio foi fazer uma abstra√ß√£o de um JSON que atendesse uma tela de amostra de uma aplica√ß√£o feita no Figma, sem seguida
gerar diagrama de classe com a sintaxe mermaid utilizando prompt em uma IA Generativa (por exemplo, ChatGPT) com o JSON criado.
Com a resposta, aprimorei o diagrama para criar uma API que pode atender uma situa√ß√£o problema real para cadastro e controle
de estudantes, cursos, turmas, matr√≠culas e notas e atenda √† tela da amostra.  
Aqui foram abordadas as etapas:  
- Amostra com Figma: visual de uma tela de aplicativo, no caso, um aplicativo que mostra notas de um aluno.
- Diagrama de classes: Utilizando IA para elaorar diagrama de classes atrav√©s de um JSON extra√≠do conforme amostra.
- Cria√ß√£o da API **ESS** 
- Cria√ß√£o de conta e de banco de dados Postgres utilizando a plataforma [Railway]

### üè´ O que √© ESS API
As sigla ESS foi formada pelo nome Escola Shining Star, nome criado para representar o produto deste projeto.  
A API foi constru√≠da com Java e SpringBoot com objetivo de gerar cadastro e controle para estudantes, cursos, turmas,
matr√≠culas e notas que uma institui√ß√£o que possui servi√ßos compat√≠veis possa utilizar.  
Este projeto disponibiliza Endpoints que viabilizam o cadastro e controle. Os endpoints est√£o documentados com
swagger e tamb√©m est√£o configurados em cole√ß√£o do postman para serem utilizados com o aplicativo para realizar as chamadas
e testes.

---

## üîß Principais tecnologias utilizadas
- **Java 21**: Vers√£o LTS mais recente do Java para tirar vantagem das √∫ltimas inova√ß√µes que essa linguagem robusta e amplamente utilizada oferece;
- **Spring Boot 3**: Vers√£o do Spring Boot, que maximiza a produtividade do desenvolvedor por meio de sua poderosa premissa de autoconfigura√ß√£o;
- **Spring Data JPA**: Ferramenta pode simplificar a camada de acesso aos dados, facilitando a integra√ß√£o com bancos de dados SQL;

---

## üñºÔ∏è Amostra com Figma

O projeto iniciou com a montagem de uma amostra da aplica√ß√£o utilizando o Figma para ser base para a abstra√ß√£o de informa√ß√µes para dar seguimento ao projeto.  
üîó [Amostra no Figma](https://www.figma.com/file/w9kOfqdYnPNcMxunBX5LGQ/ESS?type=design&node-id=0-1&mode=design)

---

## üí° Diagrama de Classes (Dom√≠nio da API)

Diagrama de classes com sintaxe [Mermaid], criado a partir da abstra√ß√£o de atributos em JSON com base na amostra do Figma e prompt com Microsoft Copilot. 

<details>
  <summary>Ver diagrama de classes criado com Microsoft Copilot</summary>

```mermaid
classDiagram
  class Student {
    - name: string
    - guardian: string
    - photo: string
    - class: Class
    - subjects: Subject[]
    - messages: Message[]
    - shortcuts: Shortcut[]
    - news: News[]
  }
  class Class {
    - name: string
    - frequency: string
    - period: string
    - status: string
  }
  class Subject {
    - name: string
    - grade: Grade
  }
  class Grade {
    - type: string
    - value: number
  }
  class Message {
    - description: string
    - dateTime: string
    - read: boolean
  }
  class Shortcut {
    - icon: string
    - name: string
  }
  class News {
    - title: string
    - description: string
  }

  Student o-- Class
  Student o-- Subject
  Subject *-- Grade
  Student o-- Message
  Student o-- Shortcut
  Student o-- News
``` 

</details>

<details>
  <summary>Prompt utilizado no Microsoft Copilot</summary>
  Gere um diagrama de classes (usando a sintaxe Mermaid) tendo em vista o seguinte JSON que repretanta um aluno de uma escola. Inclua as rela√ß√µes entre as classes. Traduza os nomes das classes e atributos para o ingl√™s. Mantenha uma estrutura simples e fiel ao modelo que vou passar:
  {
    "nome": "Maria",
    "responsavel": "Jo√£o",
    "foto": "urlFoto",
    "turma": {
      "nome": "1¬∫ Ano - A",
      "periodicidade": "Anual",
      "periodo": "2024",
      "status": "Em curso"
    },
    "materias": [
      {
        "nome": "Portugu√™s",
        "nota": {
          "tipo": "Final",
          "valor": 10
        }
      },
      {
        "nome": "Matem√°tica",
        "nota": {
          "tipo": "Final",
          "valor": 10
        }
      },
          {
        "nome": "Ci√™ncias",
        "nota": {
          "tipo": "Em curso",
          "valor": 0
        }
      }
    ],
    "mensagens":[
      {
        "descricao": "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
        "dataHora": "2024-03-02T13:02:34.000Z",
        "lida": false
      },
      {
        "descricao": "Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
        "dataHora": "2024-03-01T08:02:34.000Z",
        "lida": true
      }
    ],
    "atalhos": [
      {
        "icone": "urlIcone",
        "nome": "Conferir Pagamentos"
      },
      {
        "icone": "urlIcone2",
        "nome": "Falar com a Secretaria"
      },
      {
        "icone": "urlIcone3",
        "nome": "Autorizar Sa√≠da"
      }
    ],
    "novidades": [
      {
        "titulo": "Confira o calend√°rio escolar",
        "descricao": "Veja os feriados, data das provas e das f√©rias."
      },
      {
        "titulo": "Ensino Integral",
        "descricao": "Veja aqui as atividades programadas para o per√≠odo da tarde."
      }
    ]
  }
</details>

Com base no diagrama criado pela IA e a documenta√ß√£o do [Mermaid], o diagrama foi editado para deixar as classes no padr√£o Java e criar as rela√ß√µes para o JPA:

```mermaid
classDiagram
    class BasicEntity {
    <<Abstract>>
        - UUID id
    }
    
    class BasicItem {
    <<Abstract>>
        - String icon
        - String title
        - String description
    }

    class Student {
        - String givenName
        - String familyName
        - String guardian
        - String photo
    }

    class Course {
        - String name
        - Frequency frequency
        - Set~Message~ messages
        - Set~News~ news
        - Set~Shortcut~ shortcuts
    }

    class Clazz {
        - String name
        - Course course
        - LocalDate initDate
        - LocalDate recoveryDate
        - LocalDate endDate
    }

    class RegistrationId {
        - Student student
        - Clazz clazz
    }
    
    class Registration {
        - RegistrationId id
        - Set~Subject~ subjects
        - LocalDate registrationDate
        + RegistrationStatus status()
    }

    class Frequency {
        <<Enumeration>>
        YEARLY
        SEMI_ANNUAL
        QUARTERLY
        BIMONTHLY
        MONTHLY
    }

    class RegistrationStatus {
        <<Enumeration>>
        ONGOING
        APPROVED
        RECOVERY
        DISAPPROVED
    }

    class Message {
        - LocalDateTime dateTime
    }

    class GradeId {
        - Registration registration
        - Subject subject
    }

    class Grade {
        - GradeId id
        - GradeType type
        - BigDecimal value
    }

    class GradeType {
        <<Enumeration>>
        FINAL
        PARTIAL
        ONGOING
    }

    class Shortcut {
        - String link
    }

    class News

    class Subject

    BasicEntity <|-- BasicItem
    BasicEntity <|-- Course
    BasicEntity <|-- Clazz
    BasicEntity <|-- Student
    BasicItem <|-- Message
    BasicItem <|-- News
    BasicItem <|-- Shortcut
    BasicItem <|-- Subject
    Course ..> Frequency
    Course *-- Message
    Course *-- News
    Course *-- Shortcut
    Clazz --> Course
    RegistrationId --* Student
    RegistrationId --* Clazz
    RegistrationId <|-- Registration
    Registration --> Subject
    Registration ..> RegistrationStatus
    Grade ..> GradeType
    GradeId <|-- Grade
    GradeId --* Registration
    GradeId --* Subject
``` 

O legal desta etapa foi ver que, apesar de no modelo do Figma ter o **Estudante** como base, este n√£o era necessariamente o dom√≠nio central, existe uma depend√™ncia forte com **Curso**, **Turma** e **Matr√≠cula** para ter a rela√ß√£o do estudante com as mat√©rias e notas.

---

## üì∑ Prints do Projeto

Logotipo do produto ESS Escola Shining Star  
![ESS Logo](docs/ess/logo.png?raw=true "ESS Logo")  
  
Banner do Spring personalizado  
![ESS Custom Spring Banner](docs/banner.PNG?raw=true "ESS Custom Spring Banner")  

Console do H2 (banco de dados) mostrando as tabelas criadas e os dados de uma tabela de rela√ß√£o de muitos para muitos que relaciona o Estudante, a Turma e a Mat√©ria matriculada   
![H2 Console Tables and some Tuples](docs/h2console.PNG?raw=true "H2 Console Tables and some Tuples")  

Abaixo print do recurso de Postgres criado no [Railway]   
![Railway Postgres](docs/railwayPostgres.PNG?raw=true "Railway Postgres")  

Retorno de erro com DTO personalizado com tratamento para timestamp, status, mensagem e path utilizando a classe `me.didi.api.ess.dtos.ApiErrorDTO`  
![A return of ApiErrorDTO](docs/apierrordto.PNG?raw=true "A return of ApiErrorDTO")  

Swagger do projeto  
![Swagger / OpenApi](docs/swagger.PNG?raw=true "Swagger / OpenApi")  

Relat√≥rio de coverage gerado pelo Jacoco  
![Jacoco Report](docs/jacoco.PNG?raw=true "Jacoco Report")  

Retorno de erro na valida√ß√£o de boby em requests, no exemplo √© um POST de nova nota (grade) com o body vazio, portanto retorna os campos e respectivas mensagens:  
![Binding Result](docs/bindingResult.PNG?raw=true "Binding Result")  

Quando utiliza chamada de POST que cria novo recurso, seja um estudante, curso, turma ou mesmo o registro da matr√≠cula, o retorno tem
o header "Location" que possui link direto para chamar o recurso espec√≠fico (_GET para findById_).  
Abaixo exemplo de retorno de cadastro de um Estudante:  
![Location Header Student](docs/locationHeaderStudent.PNG?raw=true "Location Header Student")  
Abaixo exemplo de um retorno mais complexo como o Registro de Matr√≠cula:  
![Location Header Registration](docs/locationHeaderRegistration.PNG?raw=true "Location Header Registration")  

---

## ‚úîÔ∏è Testes

Os testes foram feitos utilizando o [JUnit 5], Mockito e MockMVC com Hamcrest.

- Para executar os testes pode executar sua IDE ou
- Utilizando o terminal (PowerShell, Bash ou similiar), basta executar na pasta do projeto o comando abaixo:

    ```shell
    ./mvnw clean test
    ```

_Ap√≥s o teste finalizado com sucesso, √© poss√≠vel verificar relat√≥rio de coverage em: target/site/jacoco/index.html_


## ‚öô Executando o projeto localmente

Antes de mais nada, √© preciso Possuir no m√≠nimo JDK 21 LTS instalado na m√°quina em que ir√° executar.
A execu√ß√£o do projeto pode ser feita utilizando atalhos de sua IDE ou com os comandos abaixo:

```shell
./mvnw clean package spring-boot:repackage
java -jar target/ess-0.0.1-SNAPSHOT.jar
```
_OBS: caso ocorra erro e estiver utilizando o terminal CMD, no primeiro comando basta remover o "./" antes do mvnw_

### OpenApi / Swagger
Para acessar a documenta√ß√£o do Swagger OpenAPI v3.1, acesso o link com o projeto em execu√ß√£o: http://localhost:8080/swagger-ui/index.html

### Postman
Neste projeto tem arquivo de cole√ß√£o do Postman com os Endpoints configurados: [ESS.postman_collection.json]

### üë™ Populate
Para popular dados automaticamente foram criadas classes que executam ao iniciar a aplica√ß√£o, assim a aplica√ß√£o j√° inicia com dados b√°sicos para gets.   
As classes est√£o no pacote `me.didi.api.ess.utils.populate`.

---

## üîú Desafios
Melhorias e desafios para aprimorar o projeto:
- Criar recurso para alterar estudantes, curso e turma
- Criar endpoint para adicionar ou remover mat√©rias na matr√≠cula
- Configurar pagina√ß√£o para os endpoints que retornam lista (findAll)
- Criar recurso para poder apagar estudantes, curso, turma, mat√©ria, matr√≠cula, nota, mensagem, not√≠cia e atalho:
  - Para este caso ter aten√ß√£o com a consist√™ncia de dados
  - De prefer√™ncia utilizar soft delete para permitir reverter a dele√ß√£o
- Aprimorar documenta√ß√£o OpenApi/Swagger com exemplos e descri√ß√µes para os endpoints e schemas
- Observabilidade: implementar logs e m√©tricas
- Implementar cache
- Incluir e configurar m√©todo de autentica√ß√£o e autoriza√ß√£o (por exemplo, Spring Security)
- Incluir e configurar versionamento de banco utilizando, por exemplo, flyway
- Utilizar uma solu√ß√£o de banco de dados diferente do H2 (MySQL, Postgres, etc)
- Criar testes de Integra√ß√£o
- Criar front-end/app para consumir a API
- Criar testes e2e

---

üìã Qualquer d√∫vida, sugest√£o ou cr√≠tica √© s√≥ entrar em contato ou abrir uma Issue (https://github.com/didifive).  
üíö Feito com muita dedica√ß√£o e aprendizado. #EnjoyThis

[Mermaid]: https://mermaid.js.org/
[Railway]: https://railway.app/
[ESS.postman_collection.json]: https://github.com/didifive/ess-api/blob/main/docs/ESS.postman_collection.json